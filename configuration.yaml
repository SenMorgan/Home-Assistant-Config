# Configure a default setup of Home Assistant (frontend, api, etc)
default_config:

http:
  use_x_forwarded_for: true
  trusted_proxies:
    - 172.30.33.0/24

# Text to speech
tts:
  - platform: google_translate
    service_name: google_say

homeassistant:
  customize: !include customize.yaml

group: !include groups.yaml
automation: !include automations.yaml
script: !include scripts.yaml
scene: !include scenes.yaml
# Sharing devices with Yandex Smart Home
yandex_smart_home: !include yandex.yaml
# Controlling of Yandex Station and TTS
yandex_station: !include yandex_station.yaml

recorder:
  db_url: !secret MYSQL_URL

# Discover some devices automatically
discovery:

# Write Python scripts that are exposed as services in Home Assistant
python_script:

# Makes it possible to send notifications to a wide variety of platforms
notify:

# Enables the ability to send magic packets to Wake on LAN capable devices to turn them on
wake_on_lan:

# BLE device tracker
device_tracker:
  - platform: bluetooth_le_tracker
    track_new_devices: true
    track_battery: true
    track_battery_interval: 01:00:00

camera:
  - platform: xiaomi_cloud_map_extractor
    host: !secret XIAOMI_VACUUM_HOST
    token: !secret XIAOMI_VACUUM_TOKEN
    username: !secret XIAOMI_CLOUD_USERNAME
    password: !secret XIAOMI_CLOUD_PASSWORD
    country: "de"
    draw: ["all"]
    attributes:
      - calibration_points

google_assistant:
  project_id: !secret GOOGLE_ASSISTANT_PROJ_ID
  service_account: !include google_project_id.json
  report_state: true
  exposed_domains:
    - switch
    - light
    - cover
    - media_player
    - climate
    - sensor
    - scene
    - vacuum
    - input_boolean
  entity_config:
    light.kitchen_spotlights:
      name: Kitchen spotlights
      room: Kitchen
    light.shelf_lighting:
      name: Shelf Lighting
      room: Kitchen
    light.floor_lamp:
      name: Floor Lamp
      room: Kitchen
    light.hall_lights:
      name: Hall lights
      room: Hall
    light.bar_light:
      room: Living room
      aliases:
        - STRING LIGHTS
        - STRIP LIGHTS
        - CHRISTMAS LIGHTS
    switch.string_lights:
      name: String Lights
      room: Kitchen
    switch.backyard_socket:
      name: Backyard Socket
      room: Backyard
    cover.bedroom:
      name: Cover in bedroom
      room: Bedroom
      aliases:
        - COVER
        - BLIND
        - BLINDS
    media_player.tv:
      room: Living room
    media_player.lg_webos_tv_551e:
      room: Living room
    switch.raven_engine:
      name: Engine
      room: Backyard
      aliases:
        - PASSAT
        - CAR
        - ENGINE
        - MOTOR
        - VOLKSWAGEN
        - RAVEN
    switch.raven_update_sensors:
      name: Update Ravens Sensors
      room: Backyard
      aliases:
        - UPDATE_SENSORS
        - UPDATE_PASSAT
        - UPDATE_RAVEN
    lock.raven_locks:
      name: Raven Doors
      room: Backyard
      aliases:
        - PASSAT
        - CAR
        - RAVEN
        - PASSAT_LOCKS
        - PASSAT_DOORS
        - RAVEN_LOCKS
        - RAVEN_DOORS
        - CAR_LOCKS
        - CAR_DOORS
    switch.asus_pc:
      name: PC
      room: Kitchen
    climate.thermostat:
      room: Kitchen
    sensor.aqara_door_sensor_1_temperature:
      name: Hall Door Sensor Temperature
      room: Hall
    sensor.aqara_window_sensor_1_temperature:
      name: Bedroom Window Sensor Temperature
      room: Bedroom
    vacuum.johnny:
      room: Bedroom

    ######################## UNEXPOSED ENTITIES ########################
    light.pc_backlight:
      name: PC Backlight
      room: Kitchen
      expose: false
    switch.backyard_light:
      room: Backyard
      expose: false
    input_boolean.presentation_switch:
      name: Presentation
      room: Kitchen
      expose: false
    sensor.shelf_lighting_estimated_current:
      expose: false
    switch.shelf_lighting_nightlight:
      expose: false
    switch.shelf_lighting_sync_receive:
      expose: false
    switch.shelf_lighting_sync_send:
      expose: false
    sensor.floor_lamp_estimated_current:
      expose: false
    switch.floor_lamp_nightlight:
      expose: false
    switch.floor_lamp_sync_receive:
      expose: false
    switch.floor_lamp_sync_send:
      expose: false
    sensor.pc_backlight_estimated_current:
      expose: false
    switch.pc_backlight_nightlight:
      expose: false
    switch.pc_backlight_sync_receive:
      expose: false
    switch.pc_backlight_sync_send:
      expose: false
    input_boolean.cube_1_control:
      expose: false
    input_boolean.light_brightness:
      expose: false
    binary_sensor.kalorifer:
      expose: false
    sensor.kalorifer_water_temperature:
      expose: false
    switch.udpate_sensors:
      expose: false

######################## START OF INPUT NUMBER SECTION ########################

input_number:
  alarm_1_hour:
    name: Час
    icon: mdi:timer-outline
    min: 0
    max: 23
    step: 1
  alarm_1_minutes:
    name: Минута
    icon: mdi:timer-outline
    min: 0
    max: 59
    step: 5
  alarm_2_hour:
    name: Час
    icon: mdi:timer-outline
    min: 0
    max: 23
    step: 1
  alarm_2_minutes:
    name: Минута
    icon: mdi:timer-outline
    min: 0
    max: 59
    step: 5
  alarm_3_hour:
    name: Час
    icon: mdi:timer-outline
    min: 0
    max: 23
    step: 1
  alarm_3_minutes:
    name: Минута
    icon: mdi:timer-outline
    min: 0
    max: 59
    step: 5
  alarm_4_hour:
    name: Час
    icon: mdi:timer-outline
    min: 0
    max: 23
    step: 1
  alarm_4_minutes:
    name: Минута
    icon: mdi:timer-outline
    min: 0
    max: 59
    step: 5

######################## START OF INPUT BOOLEAN SECTION ########################

input_boolean:
  cube_1_control:
    name: Cube Control
    icon: mdi:gesture-double-tap
  light_brightness:
    name: light_brightness
  presentation_switch:
    name: Presentation
    icon: mdi:presentation-play
  raven_engine_start_stop:
    name: Raven Engine Start/Stop
    icon: mdi:engine-outline
  flag_spotlight_triggered_by_motion:
    name: Flag - Spotlight Was Triggered by Motion Sensor
    icon: mdi:engine-outline
  flag_hall_lights_triggered_by_motion:
    name: Flag - Hall Lights Was Triggered by Motion Sensor
  heating_season_switch:
    name: Heating Season

###############################################
## SWITCHES
###############################################
switch:
  - platform: wake_on_lan
    mac: !secret ASUS_PC_MAC
    name: ASUS-PC
    host: !secret ASUS_PC_LOCAL_IP
    turn_off:
      service: hassio.addon_stdin
      data:
        addon: core_rpc_shutdown
        input: ASUS-PC

######################## START OF SENSORS SECTION ########################

binary_sensor:
  - platform: template
    sensors:
      people_home:
        friendly_name: People Home
        device_class: presence
        value_template: >
          {{ is_state('person.sen', 'home') or
          is_state('person.kris', 'home') }}

sensor:
  ###############################################
  ## 17TRACK Sensor
  ###############################################
  - platform: seventeentrack
    username: !secret SEVENTEENTRACK_EMAIL
    password: !secret SEVENTEENTRACK_PASSWORD

  ###############################################
  ## System Monitor Sensors
  ###############################################
  - platform: systemmonitor
    resources:
      - type: processor_use
      - type: processor_temperature
      - type: last_boot
      - type: disk_use_percent
      - type: disk_use
      - type: memory_use_percent
      - type: swap_use_percent
      - type: load_1m
      - type: network_in
        arg: eth0
      - type: network_out
        arg: eth0
      - type: packets_in
        arg: eth0
      - type: packets_out
        arg: eth0

  ###############################################
  ## Other Sensors
  ###############################################
  - platform: time_date
    display_options:
      - "time"
      - "date"

  ###############################################
  ## Alarms
  ###############################################
  - platform: template
    sensors:
      alarm_1_time:
        friendly_name: "Alarm Time"
        value_template: >-
          {{ "%0.02d:%0.02d" | format(states("input_number.alarm_1_hour") | int, states("input_number.alarm_1_minutes") | int) }}
  - platform: template
    sensors:
      alarm_2_time:
        friendly_name: "Alarm Time"
        value_template: >-
          {{ "%0.02d:%0.02d" | format(states("input_number.alarm_2_hour") | int, states("input_number.alarm_2_minutes") | int) }}
  - platform: template
    sensors:
      alarm_3_time:
        friendly_name: "Alarm Time"
        value_template: >-
          {{ "%0.02d:%0.02d" | format(states("input_number.alarm_3_hour") | int, states("input_number.alarm_3_minutes") | int) }}
  - platform: template
    sensors:
      alarm_4_time:
        friendly_name: "Alarm Time"
        value_template: >-
          {{ "%0.02d:%0.02d" | format(states("input_number.alarm_4_hour") | int, states("input_number.alarm_4_minutes") | int) }}

  ###############################################
  ## Last Changed Sensors
  ###############################################
  - platform: template
    sensors:
      hall_last_motion:
        friendly_name: "Hall Last Motion"
        value_template: >
          {{ as_timestamp(states.binary_sensor.tradfri_motion_sensor_occupancy.last_changed) | timestamp_custom('%d.%m.%Y %H:%M:%S',1) }}
      front_door_last_triggered:
        friendly_name: "Front Door Last Triggered"
        value_template: >
          {{ as_timestamp(states.binary_sensor.aqara_hall_door_sensor_contact.last_changed) | timestamp_custom('%d.%m.%Y %H:%M:%S',1) }}
      bedroom_window_last_triggered:
        friendly_name: "Bedroom Window Last Triggered"
        value_template: >
          {{ as_timestamp(states.binary_sensor.aqara_bedroom_window_sensor_contact.last_changed) | timestamp_custom('%d.%m.%Y %H:%M:%S',1) }}
      raven_last_message_received:
        friendly_name: "Raven Last Message Received"
        value_template: >
          {{ as_timestamp(states.sensor.raven_rssi.last_changed) | timestamp_custom('%d.%m.%Y %H:%M:%S',1) }}

  ###############################################
  ## DuinoCoin Statistics Sensors
  ###############################################
  - platform: statistics
    name: "Duco Mined over 1 minute"
    entity_id: sensor.duco_balance
    state_characteristic: change
    max_age:
      minutes: 1
    sampling_size: 3
    precision: 5

  - platform: statistics
    name: "Duco Mined over 5 minutes"
    entity_id: sensor.duco_balance
    state_characteristic: change
    max_age:
      minutes: 5
    sampling_size: 10
    precision: 5

  - platform: statistics
    name: "Duco Mined over 1 hour"
    entity_id: sensor.duco_balance
    state_characteristic: change
    max_age:
      hours: 1
    sampling_size: 70
    precision: 5

  - platform: statistics
    name: "Duco Mined over 1 day"
    entity_id: sensor.duco_balance
    state_characteristic: change
    max_age:
      days: 1
    sampling_size: 1500
    precision: 5

###############################################
## Input Buttons
###############################################
input_button:
  parking_light:
    name: Parking Light
    icon: mdi:spotlight

###############################################
## DuinoCoin Rest Sensors
###############################################
rest:
  - resource: !secret DUINOCOIN_USER_URI
    scan_interval: 60
    sensor:
      - name: "Duco Balance"
        value_template: "{{ value_json['result']['balance'] | round(5, default=none) }}"
        device_class: monetary
        state_class: measurement
      - name: "Duco Balance 100 Trigger"
        value_template: "{{ (value_json['result']['balance'] | float / 100) | round(0, default=none) }}"
      - name: "Duco Username"
        value_template: "{{ value_json['result']['username'] }}"
      - name: "Duco Server"
        value_template: "{{ value_json['server'] }}"

###############################################
## MQTT stuff
###############################################
mqtt:
  ###############################################
  ## CLIMATE
  ###############################################
  climate:
    - name: Thermostat
      action_topic: "kitchen/thermostat/properties"
      action_template: "{{value_json.state}}"
      temperature_command_topic: "kitchen/thermostat/set/targetTemperature"
      temperature_state_topic: "kitchen/thermostat/properties"
      temperature_state_template: "{{value_json.targetTemperature}}"
      current_temperature_topic: "kitchen/thermostat/properties"
      current_temperature_template: "{{value_json.temperature}}"
      mode_command_topic: "kitchen/thermostat/set/schedulesMode"
      mode_state_topic: "kitchen/thermostat/properties"
      mode_state_template: "{{value_json.schedulesMode}}"
      payload_on: true
      payload_off: false
      modes: ["auto", "heat", "off"] # mode off means ECO mode (14 degrees), not switching OFF device
      min_temp: 14
      max_temp: 28
      temp_step: 1
      precision: 1

  ###############################################
  ## COVERS
  ###############################################
  cover:
    - name: "Bedroom"
      device_class: shade
      command_topic: "/blinds/set"
      position_topic: "/blinds/position"
      availability:
        - topic: "/blinds/availability"
      set_position_topic: "/blinds/set_position"
      payload_open: "OPEN"
      payload_close: "CLOSE"
      payload_stop: "STOP"
      position_open: 100
      position_closed: 0
      optimistic: false
      position_template: "{{ value }}"

  ###############################################
  ## LOCKS
  ###############################################
  lock:
    - name: "Raven Locks"
      state_topic: "/Raven/locks"
      command_topic: "/Raven/set/locks"
      availability_topic: "/Raven/availability"
      optimistic: false
      qos: 1
      retain: false

  ###############################################
  ## LIGHTS
  ###############################################
  light:
    - name: "Kitchen Spotlights"
      state_topic: "/Sonoff-Spotlights/Status"
      command_topic: "/Sonoff-Spotlights/Switch"
      payload_on: "1"
      payload_off: "0"
      availability_topic: "/Sonoff-Spotlights/availability"
      payload_available: "online"
      payload_not_available: "offline"
      optimistic: false

  ###############################################
  ## BUTTONS
  ###############################################
  button:
    ###############################################
    ## Power Monitor Buttons
    ###############################################
    - name: "Power Monitor Reset"
      command_topic: "/power-monitor/set/reset"
      payload_press: "1"
      retain: true
      entity_category: "config"
      device_class: "restart"
    - name: "Power Monitor Reset Wh"
      command_topic: "/power-monitor/set/wh-reset"
      payload_press: "1"
      retain: true
      entity_category: "config"

  ###############################################
  ## SWITCHES
  ###############################################
  switch:
    ###############################################
    ## Raven Switches
    ###############################################
    - name: "Raven Engine"
      icon: mdi:engine-outline
      state_topic: "/Raven/engine/engine_running"
      state_on: "RUNNING"
      state_off: "STOPPED"
      command_topic: "/Raven/set/engine"
      payload_on: "ON"
      payload_off: "OFF"
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      optimistic: false

    - name: "Raven Udpate Sensors"
      icon: mdi:update
      state_topic: "/Raven/sensors_updating"
      command_topic: "/Raven/set/update_sensors"
      payload_on: "1"
      payload_off: "0"
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      optimistic: false

    ###############################################
    ## Solar Station Switches
    ###############################################
    - name: "Solar Power Meter Reset"
      command_topic: "/solar/reset"
      payload_on: "1"
      optimistic: true

    ###############################################
    ## Power Monitor Switches
    ###############################################
    - name: "Power Monitor Sleep Mode"
      state_topic: "/power-monitor/state/sleep"
      command_topic: "/power-monitor/set/sleep"
      payload_on: "1"
      payload_off: "0"
      optimistic: false
      retain: true
    - name: "Power Monitor Light"
      state_topic: "/power-monitor/state/light"
      command_topic: "/power-monitor/set/light"
      payload_on: "1"
      payload_off: "0"
      optimistic: false
      retain: true

    ###############################################
    ## Swimming Pool Switches
    ###############################################
    - name: "Pool Light"
      state_topic: "/pool-thermometer/state/light"
      command_topic: "/pool-thermometer/set/light"
      payload_on: "1"
      payload_off: "0"
      optimistic: false
      retain: true
    - name: "Pool Sleep Mode"
      state_topic: "/pool-thermometer/state/sleep"
      command_topic: "/pool-thermometer/set/sleep"
      payload_on: "1"
      payload_off: "0"
      optimistic: false
      retain: true

    ###############################################
    ## Other Switches
    ###############################################
    - name: "Backyard Socket"
      icon: mdi:power-socket-fr
      state_topic: "/Sonoff-Socket_01/Status"
      command_topic: "/Sonoff-Socket_01/Switch"
      payload_on: "1"
      payload_off: "0"
      availability_topic: "/Sonoff-Socket_01/availability"
      payload_available: "online"
      payload_not_available: "offline"
      optimistic: false

  ###############################################
  ## BINARY SENSORS
  ###############################################
  binary_sensor:
    - name: Garage Kalorifer
      device_class: moving
      state_topic: "/Kalorifer/Status"
      payload_on: "1"
      payload_off: "0"

    ###############################################
    ## Raven Binary Sensors
    ###############################################
    - name: "Raven Alarm"
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/alarm_flag"
      payload_on: "1"
      payload_off: "0"
      device_class: power

    - name: "Raven Error"
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/error_flag"
      payload_on: "1"
      payload_off: "0"
      device_class: power

    - name: "Raven Sleep Mode"
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/wifi/sleep_mode"
      payload_on: "1"
      payload_off: "0"
      device_class: power

  ###############################################
  ## SENSORS
  ###############################################
  sensor:
    ###############################################
    ## Swimming Pool Sensors
    ###############################################
    - name: "Pool Thermometer Battery Voltage"
      icon: mdi:battery
      state_topic: "/pool-thermometer/vcc"
      value_template: "{{ value }}"
      unit_of_measurement: "mV"

    - name: "Pool Thermometer Upper Water Temperature"
      icon: mdi:temperature-celsius
      device_class: temperature
      state_topic: "/pool-thermometer/ds18b20/upper-water-temp"
      value_template: "{{ value }}"
      unit_of_measurement: "°C"

    - name: "Pool Thermometer Bottom Water Temperature"
      icon: mdi:temperature-celsius
      device_class: temperature
      state_topic: "/pool-thermometer/ds18b20/bottom-water-temp"
      value_template: "{{ (value  | float - 0.33)  | round(2, default=none)}}"
      unit_of_measurement: "°C"

    - name: "Pool BME280 Temperature"
      icon: mdi:temperature-celsius
      state_topic: "/pool-thermometer/bme280/temp"
      device_class: temperature
      value_template: "{{ value }}"
      unit_of_measurement: "°C"

    - name: "Pool BME280 Pressure"
      state_topic: "/pool-thermometer/bme280/press"
      device_class: pressure
      value_template: "{{ value }}"
      unit_of_measurement: "hPa"

    - name: "Pool BME280 Humidity"
      icon: mdi:water-percent
      state_topic: "/pool-thermometer/bme280/hum"
      device_class: humidity
      value_template: "{{ value }}"
      unit_of_measurement: "%"

    ###############################################
    ## Air Quality Station Sensors
    ###############################################
    - name: "Air Quality Station Temperature"
      state_topic: "/air-quality-station/temperature"
      icon: mdi:temperature-celsius
      device_class: temperature
      value_template: "{{ value }}"
      unit_of_measurement: "°C"

    - name: "Air Quality Station Humidity"
      state_topic: "/air-quality-station/humidity"
      device_class: humidity
      value_template: "{{ value }}"
      unit_of_measurement: "%"

    - name: "Air Quality Station Pressure"
      state_topic: "/air-quality-station/pressure"
      device_class: pressure
      value_template: "{{ value }}"
      unit_of_measurement: "hPa"


      # From BSEC Software Library:
      #
      # The IAQ scale ranges from 0 (clean air) to 500 (heavily polluted air). During operation, algorithms
      # automatically calibrate and adapt themselves to the typical environments where the sensor is operated
      # (e.g., home, workplace, inside a car, etc.).This automatic background calibration ensures that users experience
      # consistent IAQ performance. The calibration process considers the recent measurement history (typ. up to four
      # days) to ensure that IAQ=25 corresponds to typical good air and IAQ=250 indicates typical polluted air.
    - name: "Air Quality Station IAQ"
      state_topic: "/air-quality-station/iaq"
      device_class: aqi
      value_template: "{{ value }}"
      unit_of_measurement: "IAQ"

    # The IAQ accuracy is reflects the current state of the background calibration process, such as:
    #
    # IAQ Accuracy=0 could either mean:
    # BSEC was just started, and the sensor is stabilizing (this lasts normally 5min in LP mode or 20min in ULP mode),
    # there was a timing violation (i.e. BSEC was called too early or too late), which should be indicated by a warning/error flag by BSEC,
    # IAQ Accuracy=1 means the background history of BSEC is uncertain. This typically means the gas sensor data was too stable for BSEC to clearly define its references,
    # IAQ Accuracy=2 means BSEC found a new calibration data and is currently calibrating,
    # IAQ Accuracy=3 means BSEC calibrated successfully.

    - name: "Air Quality Station IAQ Accuracy"
      state_topic: "/air-quality-station/iaqAccuracy"
      value_template: "{{ value }}"
      unit_of_measurement: "IAQ Acc"

      # co2 equivalent estimate [ppm]
    - name: "Air Quality Station CO2"
      state_topic: "/air-quality-station/co2Equivalent"
      device_class: carbon_dioxide
      value_template: "{{ value }}"
      unit_of_measurement: "ppm"

      # breath VOC concentration estimate [ppm]
    - name: "Air Quality Station VOC"
      state_topic: "/air-quality-station/breathVocEquivalent"
      value_template: "{{ value }}"
      unit_of_measurement: "ppm"

    ###############################################
    ## Solar Station Sensors
    ###############################################
    - name: "Solar Panel Voltage"
      device_class: voltage
      state_topic: "/solar/solar/volt"
      value_template: "{{ value }}"
      unit_of_measurement: "V"

    - name: "Solar Panel Current"
      device_class: current
      state_topic: "/solar/solar/amp"
      value_template: "{{ value }}"
      unit_of_measurement: "A"

    - name: "Solar Panel Power"
      device_class: power
      state_topic: "/solar/solar/watt"
      value_template: "{{ value }}"
      unit_of_measurement: "W"

    - name: "Solar Panel Energy"
      device_class: energy
      state_topic: "/solar/solar/wh"
      value_template: "{{ value }}"
      unit_of_measurement: "Wh"
      state_class: total_increasing

    - name: "Battery Charging Voltage"
      device_class: voltage
      state_topic: "/solar/batt/volt"
      value_template: "{{ value }}"
      unit_of_measurement: "V"

    - name: "Battery Charging Current"
      device_class: current
      state_topic: "/solar/batt/amp"
      value_template: "{{ value }}"
      unit_of_measurement: "A"

    - name: "Battery Charging Power"
      device_class: power
      state_topic: "/solar/batt/watt"
      value_template: "{{ value }}"
      unit_of_measurement: "W"

    - name: "Battery Charging Energy"
      device_class: energy
      state_topic: "/solar/batt/wh"
      value_template: "{{ value }}"
      unit_of_measurement: "Wh"
      state_class: total_increasing

    ###############################################
    ## Power Monitor Sensors
    ###############################################
    - name: "Power Monitor Voltage"
      device_class: voltage
      state_topic: "/power-monitor/state/volt"
      value_template: "{{ value }}"
      unit_of_measurement: "V"

    - name: "Power Monitor Current"
      device_class: current
      state_topic: "/power-monitor/state/amp"
      value_template: "{{ value }}"
      unit_of_measurement: "A"

    - name: "Power Monitor Power"
      device_class: power
      state_topic: "/power-monitor/state/watt"
      value_template: "{{ value }}"
      unit_of_measurement: "W"

    - name: "Power Monitor Energy"
      device_class: energy
      state_topic: "/power-monitor/state/wh"
      value_template: "{{ value }}"
      unit_of_measurement: "Wh"
      state_class: total_increasing

    - name: "Power Monitor Signal Quality"
      device_class: signal_strength
      state_topic: "/power-monitor/state/signal-quality"
      value_template: "{{ value }}"
      unit_of_measurement: "%"

    - name: "Power Monitor Uptime"
      state_topic: "/power-monitor/state/uptime"
      value_template: "{{ value }}"
      state_class: total_increasing

    ###############################################
    ## Raven Sensors
    ###############################################
    - name: "Raven Motor RPM"
      icon: mdi:gauge-empty
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/engine/RPM"
      value_template: "{{ value }}"
      unit_of_measurement: "RPM"

    - name: "Raven Motor Coolant Temperature"
      icon: mdi:oil-temperature
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/engine/coolant"
      value_template: "{{ value }}"
      unit_of_measurement: "°C"
      device_class: temperature

    - name: "Raven Selector Position"
      icon: mdi:cogs
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/engine/selector_position"
      value_template: "{{ value }}"

    - name: "Raven Started by Status"
      icon: mdi:key-wireless
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/started_by_status"
      value_template: "{{ value }}"

    - name: "Raven Actual Mode"
      icon: mdi:state-machine
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/actual_mode"
      value_template: "{{ value }}"

    - name: "Raven Fuel Burned"
      icon: mdi:fuel
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/engine/engine_fuel_burned"
      value_template: "{{ value }}"
      unit_of_measurement: "mg"

    - name: "Raven Fuel Level"
      icon: mdi:gas-station
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/engine/engine_fuel_level"
      value_template: "{{ value }}"

    - name: "Raven Signal"
      icon: mdi:car-connected
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/wifi/signal"
      unit_of_measurement: "%"
      value_template: "{{ value }}"
      device_class: signal_strength

    - name: "Raven RSSI"
      icon: mdi:car-connected
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/wifi/rssi"
      unit_of_measurement: "dBm"
      device_class: signal_strength

    - name: "Raven SSID"
      icon: mdi:car-connected
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/wifi/ssid"
      value_template: "{{ value }}"

    - name: "Raven WiFi channel"
      icon: mdi:car-connected
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/wifi/channel"
      value_template: "{{ value }}"

    - name: "Raven Uptime"
      icon: mdi:timer-sand
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/uptime"
      value_template: "{{ value }}"

    - name: "Raven Battery Voltage"
      icon: mdi:car-battery
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/battery_voltage"
      value_template: "{{ value }}"
      unit_of_measurement: "V"

    - name: "Raven Outside Temperature"
      icon: mdi:temperature-celsius
      device_class: temperature
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/out_temp"
      value_template: "{{ value }}"
      unit_of_measurement: "°C"

    - name: "Raven Roof Temperature"
      icon: mdi:temperature-celsius
      device_class: temperature
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/roof_temp"
      value_template: "{{ value }}"
      unit_of_measurement: "°C"

    - name: "Raven Odometer"
      icon: mdi:counter
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/odometer"
      value_template: "{{ value }}"
      unit_of_measurement: "km"

    - name: "Raven Doors Status"
      icon: mdi:car-door
      availability_topic: "/Raven/availability"
      payload_available: "online"
      payload_not_available: "offline"
      state_topic: "/Raven/doors"
      value_template: "{{ value }}"

    ###############################################
    ## Kalorifer in Garage Sensors
    ###############################################
    - name: "Garage Air Temperature"
      state_topic: "/Kalorifer/Temp"
      value_template: "{{ value }}"
      unit_of_measurement: "°C"
      availability_topic: "/Kalorifer/availability"
      device_class: temperature

    - name: "Garage Air Humidity"
      state_topic: "/Kalorifer/Hum"
      value_template: "{{ value }}"
      unit_of_measurement: "%"
      availability_topic: "/Kalorifer/availability"
      device_class: humidity

    - name: "Garage Kalorifer Water Temperature"
      state_topic: "/Kalorifer/WaterTemp"
      value_template: "{{ value }}"
      unit_of_measurement: "°C"
      availability_topic: "/Kalorifer/availability"
      device_class: temperature
